#!/usr/bin/env bash

set -euxo pipefail

URI="qemu:///system"

VM_NAME=$(virsh --connect "$URI" list --all --name | grep -v '^$' | walker --dmenu)

if ! virsh --connect "$URI" start "$VM_NAME"; then
    exit 1
fi

PATH="/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin" nohup virt-manager --connect "$URI" --show-domain-console "$VM_NAME" >/dev/null 2>&1 &
